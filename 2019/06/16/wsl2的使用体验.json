{
    "attributes": {
        "title": "wsl2的使用体验",
        "date": "2019-06-16T12:59:59.000Z",
        "tags": "Windows",
        "categories": null
    },
    "body": "<p>wsl2已经是虚拟机平台了。\n需要Windows版本在18917及以上，先开启虚拟机平台才能继续，在管理员权限的powershell中执行</p>\n<pre><code>Enable-WindowsOptionalFeature -Online -FeatureName VirtualMachinePlatform\n</code></pre>\n<p>对已安装的wsl1进行转换</p>\n<pre><code>wsl --set-version &lt;Distro&gt; 2\n</code></pre>\n<p>Distro可以通过 <code>wsl --list</code> 查看。\n转换需要点时间，完成以后就可以浪起来了。\nwsl2新增了一些参数：</p>\n<ul>\n<li><code>wsl --set-version &lt;Distro&gt; &lt;Version&gt;</code>\n可以设置某个wsl的版本，1是旧版，2是新版。</li>\n<li><code>wsl --set-default-version &lt;Version&gt;</code>\n设置默认的wsl版本，推荐设置一下。</li>\n<li><code>wsl --shutdown</code>\n出于某些目的，比如已经完成了任务，不再需要wsl工作在后台，可以手动关闭。</li>\n<li><code>wsl --list --quiet</code>\n仅列出分发名称，此命令对于脚本编写很有用，因为它只会输出您已安装的发行版的名称，而不显示其他信息，如默认发行版，版本等。</li>\n<li><code>wsl --list --verbose</code>\n显示有关所有分发的详细信息。此命令列出每个发行版的名称，发行版所处的状态以及正在运行的版本。它还显示哪些分发是默认的星号。\n当一切准备就绪，我就安装了docker，测试一波。</li>\n</ul>\n<pre><code>sudo apt install docker-ce\n</code></pre>\n<p>添加用户到docker组。</p>\n<pre><code>sudo usermod -aG docker $USER\n</code></pre>\n<pre><code>sudo service docker --full-restart\n</code></pre>\n<p>已经可以跑docker了，我们来做个测试，请出万能的hello world！</p>\n<pre><code>docker pull hello-world\n</code></pre>\n<pre><code>docker run --rm hello-world\n</code></pre>\n<p>然后就看到了想要的结果，hello world成功的跑起来了。</p>\n<pre><code>Hello from Docker!\nThis message shows that your installation appears to be working correctly.\nTo generate this message, Docker took the following steps:\n 1. The Docker client contacted the Docker daemon.\n 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.\n    (amd64)\n 3. The Docker daemon created a new container from that image which runs the\n    executable that produces the output you are currently reading.\n 4. The Docker daemon streamed that output to the Docker client, which sent it\n    to your terminal.\nTo try something more ambitious, you can run an Ubuntu container with:\n $ docker run -it ubuntu bash\nShare images, automate workflows, and more with a free Docker ID:\n https://hub.docker.com/\nFor more examples and ideas, visit:\n https://docs.docker.com/get-started/\n</code></pre>\n<p>总的来说，因为wsl2改成虚拟机方案了，不过wsl2的启动速度还是挺快的，微软也努力让wsl2和wsl1之间在使用上没有差异。目前微软还没有完成wsl2的网络部分，wsl2和宿主机之间还需要使用专门的ip进行访问，等微软完成wsl2的localhost网络以后，就可以像以前一样直接跑一些网站或者需要端口的服务了。\n<img src=\"Snipaste_2019-06-16_21-52-42.png\" alt=\"网络截图\">\n来一张合照\n<img src=\"Snipaste_2019-06-16_21-49-15.png\" alt=\"合照\">\n<a href=\"https://devblogs.microsoft.com/commandline/wsl-2-is-now-available-in-windows-insiders/\">点我查看wsl2的发布说明</a>\n<a href=\"https://docs.microsoft.com/en-us/windows/wsl/wsl2-install\">点我查看如何安装wsl2</a></p>\n",
    "id": "99ec8a9d9ba3a68bd318ba53b3cc288f",
    "link": "/2019/06/16/wsl2的使用体验"
}