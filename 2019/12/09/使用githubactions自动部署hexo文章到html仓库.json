{
    "attributes": {
        "title": "使用github actions自动部署hexo文章到html仓库",
        "date": "2019-12-09T13:19:11.000Z",
        "tags": null,
        "categories": null
    },
    "body": "<p>请先允许我大喊一声：微软牛逼！\n本文没有啥含金量，就是简单的说一下如何部署github-actions来自动生成hexo的public，并且再推送到html仓库的。\n我的博客仓库一共分为两个，blog仓库是私有的，需要通过我的私钥才能访问，html仓库是公开的，hexo生成的静态内容会被上传到这里。\n首先在package.json中添加一些命令，方便我们一键编译和提交:</p>\n<pre><code>  &quot;scripts&quot;: {\n    &quot;build&quot;: &quot;hexo clean &amp;&amp; hexo g&quot;,\n    &quot;deploy&quot;: &quot;yarn run build &amp;&amp; hexo d&quot;,\n    &quot;backup&quot;: &quot;hexo b&quot;,\n  }\n</code></pre>\n<p>因为CI环境需要提交代码到仓库，所以申请一个个人用的token，访问<a href=\"https://github.com/settings/tokens\">https://github.com/settings/tokens</a>创建一个新的，勾选上<code>repo</code>，生成完token以后，修改一下<code>_config.yml</code>中对deploy仓库的url，格式固定为<code>https://x-access-token:你的token@github.com/你的名字/仓库名.git</code>,例如我这里是<code>https://x-access-token:xxxxxxxxxx@github.com/justforlxz/html.git</code>。\n然后新家一个github actions，选择nodejs环境，我们只需要修改最后一个步骤，执行我们自己的命令即可。</p>\n<ul>\n<li>设置git的用户名和邮箱地址</li>\n<li>npm install -g yarn</li>\n<li>yarn run deploy\n如果你还有一些其他步骤，可以自行扩展，比如我就有主题相关的操作，具体的内容如下:</li>\n</ul>\n<pre><code>    - name: npm install, build, and deploy\n      run: |\n        git config --global user.email &quot;justforlxz@gmail.com&quot;\n        git config --global user.name &quot;justforlxz&quot;\n        git submodule update --init\n        cd themes/next\n        git checkout dev\n        cd ../../\n        npm install -g yarn\n        yarn\n        yarn run deploy\n</code></pre>\n<p>然后就可以愉快的自动部署了。</p>\n",
    "id": "24ebd17d4a71c5ccdfd73cadcf614ff1",
    "link": "/2019/12/09/使用githubactions自动部署hexo文章到html仓库"
}